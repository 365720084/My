<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PtgAdSDK使用文档</title>
    <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
<div class="stackedit__html"><h2><a id="_1_1"></a>步骤 1：工程设置</h2>
    <h3><a id="_aar_2"></a>自动集成及导入 aar</h3>
    <p>通过在Android Studio工程build.gradle配置脚本中添加maven线上依赖，导入最新版本SDK。</p>
    <pre><code class="prism language-java">    implementation <span class="token string">'com.lucky.ptgad:ptgad:1.0.32'</span>
    implementation <span class="token string">'com.lucky.ptgad:csj:1.0.32'</span>
    implementation <span class="token string">'com.lucky.ptgad:gdt:1.0.32'</span>
    implementation <span class="token string">'com.lucky.ptgad:ptgapi:1.0.32'</span>
</code></pre>
    <p>将本 SDK 压缩包内的 open_ad_sdk.aar 和复制到 Application Module/libs 文件夹(没有的话须手动创建), 并将以下代码添加到您 app 的</p>
    <pre><code class="prism language-java">
repositories <span class="token punctuation">{</span>
    flatDir <span class="token punctuation">{</span>
        dirs <span class="token string">'libs'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
depedencies <span class="token punctuation">{</span>
    <span class="token function">compile</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token string">'open_ad_sdk'</span><span class="token punctuation">,</span> ext<span class="token operator">:</span> ‘aar'<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


</code></pre>
    <h2><a id="_29"></a>步骤二：全局配置</h2>
    <h3><a id="_30"></a>添加权限</h3>
    <p>PtgAdSDK建议您添加下述权限，并建议在您的隐私协议中向开发者声明穿山甲SDK会获取下述权限并应用于广告投放</p>
    <pre><code class="prism language-java">
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>必要权限<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.INTERNET"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.ACCESS_NETWORK_STATE"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>可选权限<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.READ_PHONE_STATE"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.WRITE_EXTERNAL_STORAGE"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.ACCESS_WIFI_STATE"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.ACCESS_COARSE_LOCATION"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.REQUEST_INSTALL_PACKAGES"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.GET_TASKS"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.ACCESS_FINE_LOCATION"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 如果有视频相关的广告且使用textureView播放，请务必添加，否则黑屏 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.permission.WAKE_LOCK"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>


</code></pre>
    <p>注意：PtgAdSDK不强制获取以上权限，即使没有获取可选权限SDK也能正常运行；获取以上权限将帮助Ptg优化投放广告精准度和用户的交互体验，提高eCPM。</p>
    <h3><a id="_Android70__54"></a>适配 Android7.0 及以上</h3>
    <p>如果您的应用需要在 Android7.0 及以上环境运行，请在 AndroidManifest 中添加如下代码：</p>
    <pre><code class="prism language-java">
<span class="token operator">&lt;</span>provider
 android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"com.bytedance.sdk.openadsdk.TTFileProvider"</span>
 android<span class="token operator">:</span>authorities<span class="token operator">=</span><span class="token string">"${applicationId}.TTFileProvider"</span>
 android<span class="token operator">:</span>exported<span class="token operator">=</span><span class="token string">"false"</span>
 android<span class="token operator">:</span>grantUriPermissions<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>meta<span class="token operator">-</span>data
     android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.support.FILE_PROVIDER_PATHS"</span>
     android<span class="token operator">:</span>resource<span class="token operator">=</span><span class="token string">"@xml/file_paths"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>provider<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>provider
     android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.support.v4.content.FileProvider"</span>
     android<span class="token operator">:</span>authorities<span class="token operator">=</span><span class="token string">"${applicationId}.fileprovider"</span>
     android<span class="token operator">:</span>exported<span class="token operator">=</span><span class="token string">"false"</span>
     android<span class="token operator">:</span>grantUriPermissions<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span>meta<span class="token operator">-</span>data
         android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"android.support.FILE_PROVIDER_PATHS"</span>
         android<span class="token operator">:</span>resource<span class="token operator">=</span><span class="token string">"@xml/gdt_file_path"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>provider<span class="token operator">&gt;</span>
</code></pre>
    <p>在 res/xml 目录下，新建一个 xml 文件 file_paths，在该文件中添加如下代码：</p>
    <pre><code class="prism language-java">
<span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>paths<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span>external<span class="token operator">-</span>path name<span class="token operator">=</span><span class="token string">"tt_external_root"</span> path<span class="token operator">=</span><span class="token string">"."</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>external<span class="token operator">-</span>path name<span class="token operator">=</span><span class="token string">"tt_external_download"</span> path<span class="token operator">=</span><span class="token string">"Download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>external<span class="token operator">-</span>files<span class="token operator">-</span>path name<span class="token operator">=</span><span class="token string">"tt_external_files_download"</span> path<span class="token operator">=</span><span class="token string">"Download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>files<span class="token operator">-</span>path name<span class="token operator">=</span><span class="token string">"tt_internal_file_download"</span> path<span class="token operator">=</span><span class="token string">"Download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>cache<span class="token operator">-</span>path name<span class="token operator">=</span><span class="token string">"tt_internal_cache_download"</span> path<span class="token operator">=</span><span class="token string">"Download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>paths<span class="token operator">&gt;</span>
</code></pre>
    <p>新建一个 xml 文件 gdt_file_path，在该文件中添加如下代码：</p>
    <pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>paths<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 这个下载路径也不可以修改，必须为GDTDOWNLOAD <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>external<span class="token operator">-</span>cache<span class="token operator">-</span>path
        name<span class="token operator">=</span><span class="token string">"gdt_sdk_download_path1"</span>
        path<span class="token operator">=</span><span class="token string">"com_qq_e_download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>cache<span class="token operator">-</span>path
        name<span class="token operator">=</span><span class="token string">"gdt_sdk_download_path2"</span>
        path<span class="token operator">=</span><span class="token string">"com_qq_e_download"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>paths<span class="token operator">&gt;</span>
</code></pre>
    <h3><a id="provider__105"></a>provider 配置</h3>
    <p>注意：单进程或多进程都必须配置</p>
    <pre><code class="prism language-java">
<span class="token operator">&lt;</span>provider
    android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"com.bytedance.sdk.openadsdk.multipro.TTMultiProvider"</span>
    android<span class="token operator">:</span>authorities<span class="token operator">=</span><span class="token string">"${applicationId}.TTMultiProvider"</span>
    android<span class="token operator">:</span>exported<span class="token operator">=</span><span class="token string">"false"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre>
    <h3><a id="_115"></a>代码混淆配置</h3>
    <p>如果您需要使用 proguard 混淆代码，需确保不要混淆 SDK 的代码。 请在 proguard.cfg 文件(或其他混淆文件)尾部添加如下配置:</p>
    <pre><code class="prism language-java">
<span class="token operator">-</span>keep <span class="token keyword">class</span> <span class="token class-name">com<span class="token punctuation">.</span>bytedance<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>openadsdk<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token operator">*</span> <span class="token punctuation">{</span> <span class="token operator">*</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token operator">-</span>keep <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">com<span class="token punctuation">.</span>bytedance<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>openadsdk<span class="token punctuation">.</span>downloadnew<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token operator">*</span> <span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">-</span>keep <span class="token keyword">class</span> <span class="token class-name">com<span class="token punctuation">.</span>pgl<span class="token punctuation">.</span>sys<span class="token punctuation">.</span>ces<span class="token punctuation">.</span></span><span class="token operator">*</span> <span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token punctuation">}</span>


</code></pre>
    <h2><a id="SDK__127"></a>SDK 初始化配置</h2>
    <p>开发者需要在 Application#onCreate()方法中调用以下代码来初始化网盟 sdk。 目前 sdk 已支持多进程，必须在所有进程都初始化！</p>
    <pre><code class="prism language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token keyword">extends</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> String PROCESS_NAME_XXXX <span class="token operator">=</span> <span class="token string">"process_name_xxxx"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//强烈建议在应用对应的Application#onCreate()方法中调用，避免出现content为null的异常</span>
       String average <span class="token operator">=</span> <span class="token string">"http://fanvy-video.oss-cn-beijing.aliyuncs.com/policy_192.json"</span><span class="token punctuation">;</span>
        PtgSDKConfig config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PtgSDKConfig<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">setPolicyUrl</span><span class="token punctuation">(</span>average<span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">setAppName</span><span class="token punctuation">(</span><span class="token string">"趣有钱"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
                <span class="token function">setPtgAppId</span><span class="token punctuation">(</span><span class="token string">"192"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token comment">//ptg后台创建的应用ID</span>
                <span class="token function">setTtAppId</span><span class="token punctuation">(</span><span class="token string">"5064176"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token comment">//穿山甲后台创建的应用ID</span>
                <span class="token function">setGdtAppId</span><span class="token punctuation">(</span><span class="token string">"1110408491"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token comment">//广点通后台创建的应用ID</span>
                <span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        PtgAdSdk<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> config<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">TTProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">PtgApiProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">GdtProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3><a id="_157"></a>初始化接口说明</h3>
    <pre><code class="prism language-java"> <span class="token comment">/**
     * ptgAdsdk初始化入口
     *
     * @param context 必须是application context
     * @param config  初始化配置信息，必要参数
     * @param providers 需要分发的广告SDK,包括PtgApiProvider、TTProvider、GdtProvider等
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NonNull</span> Context context<span class="token punctuation">,</span> PtgSDKConfig config<span class="token punctuation">,</span> PtgAdNative<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> providers<span class="token punctuation">)</span> <span class="token punctuation">;</span>
</code></pre>
    <h3><a id="_169"></a>初始化配置参数说明：</h3>
    <pre><code class="prism language-java">
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">PtgAdConfig<span class="token punctuation">.</span>Builder</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> String policyUrl<span class="token punctuation">;</span>
        <span class="token keyword">private</span> String appName<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token comment">// 必选参数，设置应用名称</span>
        <span class="token keyword">private</span> String ptgAppId<span class="token punctuation">;</span><span class="token comment">// 必选参数，设置应用的AppId</span>
        <span class="token keyword">private</span> String ttAppId<span class="token punctuation">;</span><span class="token comment">//可选参数，设置应用的穿山甲AppId</span>
        <span class="token keyword">private</span> String gdtAppId<span class="token punctuation">;</span><span class="token comment">//可选参数，设置应用的广点通AppId</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> debug<span class="token punctuation">;</span><span class="token comment">// 可选参数，是否打开debug调试信息输出：true打开、false关闭。默认false关闭</span>
        <span class="token keyword">private</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> providers<span class="token punctuation">;</span><span class="token comment">//必选参数，至少设置一个Provider</span>


    <span class="token punctuation">}</span>
</code></pre>
    <h2><a id="_186"></a>开屏广告</h2>
    <p>SDK 为接入方提供了开屏广告，开屏广告建议为用户在进入 App 时展示的全屏广告。开屏广告为一个 View，宽高默认为 match_parent,注意开屏广告 view：width &gt;=70%屏幕宽；height &gt;=50%屏幕高 ，否则会影响计费。</p>
    <h3><a id="_188"></a>加载广告</h3>
    <pre><code class="prism language-java">    AdSlot adSlot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AdSlot<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPtgSlotId</span><span class="token punctuation">(</span>ptgSlotId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSplashType</span><span class="token punctuation">(</span>ptgType<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSupportDeepLink</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setNeedSkipView</span><span class="token punctuation">(</span>needCountdown<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setImageAcceptedSize</span><span class="token punctuation">(</span><span class="token number">1080</span><span class="token punctuation">,</span> <span class="token number">1920</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setAdContainer</span><span class="token punctuation">(</span>mSplashContainer<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        PtgAdSdk<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadSplashAd</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> adSlot<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PtgAdNative<span class="token punctuation">.</span>SplashAdListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">,</span> String var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"开屏请求超时"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>



            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onSplashAdLoad</span><span class="token punctuation">(</span>PtgSplashAd ad<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">"开屏广告请求成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ad <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//获取SplashView</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>SplashAdActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isFinishing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">goToMainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                ad<span class="token punctuation">.</span><span class="token function">setSplashInteractionListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PtgSplashAd<span class="token punctuation">.</span>AdInteractionListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAdClicked</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAdShow</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAdSkip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">goToMainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>

                    <span class="token annotation punctuation">@Override</span>
                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAdTimeOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">goToMainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
    <h3><a id="PtgSplashAd__253"></a>PtgSplashAd 广告接口说明：</h3>
    <pre><code class="prism language-java">
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PtgSplashAd</span> <span class="token punctuation">{</span>

  <span class="token comment">/**
   * 得到开屏广告
   *
   * @return
   */</span>
  <span class="token annotation punctuation">@NonNull</span>
  View <span class="token function">getSplashView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 得到Splash广告的交互类型
   *
   * @return 0:下载应用，1落地页（普通类型），3:拨打电话 -1 未知类型
   */</span>
  <span class="token keyword">int</span> <span class="token function">getInteractionType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * 注册Splash广告交互回调
   *
   * @param listener 监听器
   */</span>
  <span class="token keyword">void</span> <span class="token function">setSplashInteractionListener</span><span class="token punctuation">(</span>AdInteractionListener listener<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">interface</span> <span class="token class-name">AdInteractionListener</span> <span class="token punctuation">{</span>
      <span class="token comment">/**
       * Splash广告的点击回调
       *
       * @param view Splash广告
       * @param type Splash广告的交互类型
       */</span>
      <span class="token keyword">void</span> <span class="token function">onAdClicked</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">/**
       * Splash广告的展示回调 每个广告仅回调一次
       *
       * @param view Splash广告
       * @param type Splash广告的交互类型
       */</span>
      <span class="token keyword">void</span> <span class="token function">onAdShow</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">/**
       * 点击跳过时回调
       */</span>
      <span class="token keyword">void</span> <span class="token function">onAdSkip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">/**
       * 广告播放时间结束
       */</span>
      <span class="token keyword">void</span> <span class="token function">onAdTimeOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre>
    <h2><a id="_312"></a>信息流广告</h2>
    <h3><a id="PtgNativeExpressAd_313"></a>模板渲染（PtgNativeExpressAd）</h3>
    <p>本 SDK 为接入方提供个性化模板信息流广告，支持图文和视频样式，开发者不用自行对广告样式进行编辑和渲染，可直接调用相关接口获取广告 view,广告样式模板以及微调后期支持开发者编辑。</p>
    <pre><code class="prism language-java">
        AdSlot adSlot <span class="token operator">=</span> null<span class="token punctuation">;</span>
        adSlot <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AdSlot<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSupportDeepLink</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPtgSlotId</span><span class="token punctuation">(</span><span class="token string">"17029"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setExpressViewAcceptedSize</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//必填：期望个性化模板广告view的size,单位dp 高度设置为0,则高度会自适应</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        PtgAdSdk<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadNativeExpressAd</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> adSlot<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PtgAdNative<span class="token punctuation">.</span>NativeExpressAdListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">int</span> code<span class="token punctuation">,</span> String message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Log<span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNativeExpressAdLoad</span><span class="token punctuation">(</span>PtgNativeExpressAd ad<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>ad <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// 插入广告</span>
                ListCommonModel m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListCommonModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                m<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">"ad"</span><span class="token punctuation">;</span>
                m<span class="token punctuation">.</span>ptgNativeExpressAd <span class="token operator">=</span> ad<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>mList<span class="token operator">==</span>null<span class="token operator">||</span>mList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">int</span> random<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
                mList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>random<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
                mAdapter<span class="token punctuation">.</span><span class="token function">notifyItemInserted</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
</code></pre>
    <h3><a id="PtgNativeExpressAd__351"></a>PtgNativeExpressAd 广告接口说明：</h3>
    <pre><code class="prism language-java">
<span class="token comment">/**
 * 模板信息流广告实体类的操作接口
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PtgNativeExpressAd</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 得到模板信息流广告广告view
     *
     * @return
     */</span>
    View <span class="token function">getExpressAdView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 得到原生广告图片模式
     *
     * @return 3 大图 2小图 4 组图 5 视频 其它：未知类型
     */</span>
    <span class="token keyword">int</span> <span class="token function">getImageMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 获取负反馈选项数据
     *
     * @return
     */</span>
    List<span class="token generics function"><span class="token punctuation">&lt;</span>FilterWord<span class="token punctuation">&gt;</span></span> <span class="token function">getFilterWords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 注册模板信息流广告交互回调
     *
     * @param listener 监听器
     */</span>
    <span class="token keyword">void</span> <span class="token function">setExpressInteractionListener</span><span class="token punctuation">(</span>ExpressAdInteractionListener listener<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">/**
      * 注册模板插屏广告交互回调
      *
      * @param listener 监听器
      */</span>
     <span class="token keyword">void</span> <span class="token function">setExpressInteractionListener</span><span class="token punctuation">(</span>AdInteractionListener listener<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 注册广告的下载回调
     *
     * @param downloadListener 下载回调监听器
     */</span>
    <span class="token keyword">void</span> <span class="token function">setDownloadListener</span><span class="token punctuation">(</span>TTAppDownloadListener downloadListener<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 得到广告的交互类型
     *
     * @return 2在浏览器内打开 （普通类型）3落地页（普通类型），4:应用下载，5:拨打电话 -1 未知类型
     */</span>
    <span class="token keyword">int</span> <span class="token function">getInteractionType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 渲染个性化模板广告
     */</span>
    <span class="token keyword">void</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 资源释放
     */</span>
    <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 设置在模板信息流广告中使用中dislike
     *
     * @param activity 创建dislike的context
     * @param dislikeInteractionCallback dislike选择结果回调
     */</span>
    <span class="token keyword">void</span> <span class="token function">setDislikeCallback</span><span class="token punctuation">(</span>Activity activity<span class="token punctuation">,</span> TTAdDislike<span class="token punctuation">.</span>DislikeInteractionCallback dislikeInteractionCallback<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 自定义dislike dialog
     *
     * @param dialog 自定义dialog，需要由外部传入
     * @return
     */</span>
    <span class="token keyword">void</span> <span class="token function">setDislikeDialog</span><span class="token punctuation">(</span>TTDislikeDialogAbstract dialog<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 展示插屏广告
     *
     * @param activity 宿主activity,用户判断宿主是否finishing
     */</span>
    <span class="token annotation punctuation">@MainThread</span>
    <span class="token keyword">void</span> <span class="token function">showInteractionExpressAd</span><span class="token punctuation">(</span>Activity activity<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 设置Banner广告轮播的间隔时间，如果不设置则默认不开启轮播
     *
     * @param intervalTime Banner广告轮播的间隔时间，允许值在30 * 1000 ~ 120 * 1000之间
     */</span>
    <span class="token keyword">void</span> <span class="token function">setSlideIntervalTime</span><span class="token punctuation">(</span><span class="token keyword">int</span> intervalTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

     <span class="token comment">/**
     * 设置视频广告的回调监听
     *
     * @param videoAdListener  个性化模板视频广告的监听
     */</span>
    <span class="token keyword">void</span> <span class="token function">setVideoAdListener</span><span class="token punctuation">(</span>ExpressVideoAdListener videoAdListener<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 模板广告中视频广告是否可以点击暂停、继续播放
     *
     * @param canInterruptVideoPlay
     */</span>
    <span class="token keyword">void</span> <span class="token function">setCanInterruptVideoPlay</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> canInterruptVideoPlay<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 广告交互监听器
     */</span>
    <span class="token keyword">interface</span> <span class="token class-name">ExpressAdInteractionListener</span> <span class="token punctuation">{</span>

        <span class="token comment">/**
         *广告的点击回调
         * @param view 广告
         * @param type 广告的交互类型
         */</span>
        <span class="token keyword">void</span> <span class="token function">onAdClicked</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 广告的展示回调 每个广告仅回调一次
         * @param view 广告view
         * @param type 广告的交互类型
         */</span>
        <span class="token keyword">void</span> <span class="token function">onAdShow</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">int</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 模板渲染失败
         * @param view
         */</span>
        <span class="token keyword">void</span> <span class="token function">onRenderFail</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> String msg<span class="token punctuation">,</span> <span class="token keyword">int</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 模板渲染成功
         * @param view
         * @param width  返回view的宽 单位 dp
         * @param height 返回view的高 单位 dp
         */</span>
        <span class="token keyword">void</span> <span class="token function">onRenderSuccess</span><span class="token punctuation">(</span>View view<span class="token punctuation">,</span> <span class="token keyword">float</span> width<span class="token punctuation">,</span> <span class="token keyword">float</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 模板信息流视频广告回调接口
     */</span>
    <span class="token keyword">interface</span> <span class="token class-name">ExpressVideoAdListener</span> <span class="token punctuation">{</span>

        <span class="token comment">/**
         * 视频广告加载成功
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频广告加载失败（原生MediaPlayer内部提供的错误类型）
         * @param errorCode 错误类型：
         *                  MEDIA_ERROR_UNKNOWN
         *                  MEDIA_ERROR_SERVER_DIED
         *
         * @param extraCode 额外错误信息
         *                  MEDIA_ERROR_IO
         *                  MEDIA_ERROR_MALFORMED
         *                  MEDIA_ERROR_UNSUPPORTED
         *                  MEDIA_ERROR_TIMED_OUT
         *                  MEDIA_ERROR_SYSTEM
         *
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoError</span><span class="token punctuation">(</span><span class="token keyword">int</span> errorCode<span class="token punctuation">,</span> <span class="token keyword">int</span> extraCode<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频广告播放回调
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoAdStartPlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频广告暂停回调
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoAdPaused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频广告续播
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoAdContinuePlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频播放进度
         *
         * @param current
         * @param duration
         */</span>
        <span class="token keyword">void</span> <span class="token function">onProgressUpdate</span><span class="token punctuation">(</span><span class="token keyword">long</span> current<span class="token punctuation">,</span> <span class="token keyword">long</span> duration<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 视频广告播放完成回调
         */</span>
        <span class="token keyword">void</span> <span class="token function">onVideoAdComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/**
         * 点击重播
         */</span>
        <span class="token keyword">void</span> <span class="token function">onClickRetry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre>
</div>
</body>

</html>
